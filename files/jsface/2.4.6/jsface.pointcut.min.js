/*
 * JSFace Object Oriented Programming Library.
 * Copyright (c) Tan Nhu, http://lnkd.in/tnhu
 */
!function(a){function b(a,b,c,d){function e(){for(var a,b,c=e[k],d=c.length,f=e[l],g=f.length,h=e[m];d--;)if(b=c[d].apply(this,arguments),i(b)&&b.$skip===!0)return b.$data;for(a=h.apply(this,arguments);g--;)if(b=f[g].apply(this,arguments),i(b)&&b.$skip===!0)return a;return a}return a[j]===a?(a[k].push(b),a[l].push(c),a[n].push(d),a):(h(e,a,0,!0),f(a)&&(e.prototype=a.prototype),e[k]=[b],e[l]=[c],e[m]=a,e[n]=[d],e[j]=e,e.$super=a.$super,e.$superp=a.$superp,e)}function c(a,b){var d,e,f;if(a&&a===a[j])if(b){for(e=f=a[n].length;e--&&a[n][e]!==b;);if(e>=0){if(1===f)return c(a);a[n].splice(e,1),a[k].splice(e,1),a[l].splice(e,1)}}else d=a[m],delete a[m],delete a[n],delete a[k],delete a[l],delete a[j];return d}function d(a,b,d,e,f,g){function h(b,d){var f,h,j,k;for(f in b)h=f/1==f?b[f]:f,j="constructor"===h,k=e&&a[h],"constructor"===h&&e?i=c(e,d):(a[h]&&(a[h]=c(a[h],d)),g[h]&&(g[h]=c(g[h],d)))}var i,k,l;if("remove"===b)if(d)h(d,d);else{i=e&&a===a[j]&&a[m];for(var n in g)g[n]=c(g[n])||g[n];for(var n in a)a[n]=c(a[n])||a[n]}else{if(null===(k=/^remove /.exec(b)))throw"Invalid params";l=b.replace(k,"").split(" "),h(l)}return i||a}var e=a.jsface||require("./jsface"),f=(e.Class,e.classOrNil),g=e.functionOrNil,h=e.extend,i=e.mapOrNil,j="___wrapper___",k="___before_fns___",l="___after_fns___",m="___origin_fn___",n="___advisors___",o=function(){};e.pointcut=function(a,c){var e,h,j,k=f(a)||g(a),l=i(a),m=null!==/^remove ?/.exec(c),n=m&&arguments[2];if(!k&&!l||!i(c)&&!m)throw"Invalid params";if(e=k?a.prototype:a,m)return d(a,c,n,k,l,e);for(h in c){j=c[h],j=g(j)?{before:j}:j;var p=i(j)&&!j.before?o:j.before,q=i(j)&&!j.after?o:j.after,r=!1;if(!g(p))throw"Invalid "+h+":before";if(!g(q))throw"Invalid "+h+":after";if(l){if(!g(e[h]))throw"Non-function property named "+h+" on instance";e[h]=b(e[h],p,q,c)}else if("constructor"===h)a=b(a,p,q,c);else if(g(a[h])&&(a[h]=b(a[h],p,q,c),r=!0),g(e[h])&&(e[h]=b(e[h],p,q,c),r=!0),!r)throw"Non-function property named "+h+" on class"}return a},"undefined"!=typeof module&&module.exports&&(module.exports=e.pointcut)}(this);